jQuery((function(n){const nameSelector=function(n,t=""){const e=n.replace(/_/g,"-");return`${t}[data-base-name="${n}"], ${t}[name="${n}"], ${t}[name="${e}"]`},t={backgroundImage:nameSelector("background-image","input"),horizontalAlignment:nameSelector("horizontal_alignment","input"),verticalAlignment:nameSelector("vertical_alignment","input"),customHorizontalNumber:nameSelector("custom_horizontal_alignment_number","input"),customHorizontalUnit:nameSelector("custom_horizontal_alignment_unit","select"),customVerticalNumber:nameSelector("custom_vertical_alignment_number","input"),customVerticalUnit:nameSelector("custom_vertical_alignment_unit","select"),backgroundRepeat:nameSelector("background-repeat","select"),backgroundAttachment:nameSelector("background-attachment","select"),backgroundSize:nameSelector("background-size","input"),customBackgroundWidthNumber:nameSelector("custom_background_size_width_number","input"),customBackgroundWidthUnit:nameSelector("custom_background_size_width_unit","select"),customBackgroundHeightNumber:nameSelector("custom_background_size_height_number","input"),customBackgroundHeightUnit:nameSelector("custom_background_size_height_unit","select")},parseJson=function(t){try{const e=JSON.parse(t);return n.isPlainObject(e)?e:{}}catch(n){return{}}},getAlignmentValue=function(n,e){const i="horizontal"===e,c=i?t.horizontalAlignment:t.verticalAlignment,o=i?t.customHorizontalNumber:t.customVerticalNumber,a=i?t.customHorizontalUnit:t.customVerticalUnit,r=n.find(c).filter(":checked").val();if("custom"===r){const t=n.find(o).val(),e=n.find(a).val();if(`${t}`.length)return`${t}${e}`}return r||""},getBackgroundSizeValue=function(n){const e=n.find(t.backgroundSize).filter(":checked").val();if("custom"===e){const e=n.find(t.customBackgroundWidthNumber).val(),i=n.find(t.customBackgroundWidthUnit).val(),c=n.find(t.customBackgroundHeightNumber).val(),o=n.find(t.customBackgroundHeightUnit).val();if(`${e}`.length&&`${c}`.length)return`${e}${i} ${c}${o}`}return e||""},setHiddenValue=function(t,e={}){const i=t.closest(".background-image-wrapper"),c=function(n){const t=n.find('input[type="hidden"]').val();return t&&"[]"!==t?parseJson(t):{}}(i);let o=n.isPlainObject(c)?c:{};o=n.extend(o,e);const a=getAlignmentValue(i,"horizontal")||o.horizontal_alignment||"center",r=getAlignmentValue(i,"vertical")||o.vertical_alignment||"center",u=void 0!==e["background-size"]?e["background-size"]:getBackgroundSizeValue(i)||o["background-size"];o.horizontal_alignment=a,o.vertical_alignment=r,u&&(o["background-size"]=u),o["background-position"]=`${a} ${r}`,i.find('input[type="hidden"]').val(JSON.stringify(o))},toggleCustomWrappers=function(n){const e=n.find(t.horizontalAlignment).filter(":checked").val(),i=n.find(t.verticalAlignment).filter(":checked").val(),c=n.find(t.backgroundSize).filter(":checked").val();n.find(".custom-horizontal_alignment-wrapper")["custom"===e?"show":"hide"](),n.find(".custom-vertical_alignment-wrapper")["custom"===i?"show":"hide"](),n.find(".custom-background-size-wrapper")["custom"===c?"show":"hide"]()};n(".background-image-wrapper").each((function(){const e=n(this),i=e.find('input[type="hidden"]').val();if(i){const c=parseJson(i);n.each(c,(function(n,i){const c=nameSelector(n),o=e.find(c);if(o.length)if(!o.is(":radio")||"horizontal_alignment"!==n&&"vertical_alignment"!==n)if(o.is(":radio")&&"background-size"===n)if("auto"!==i&&"cover"!==i&&"contain"!==i){o.filter('[value="custom"]').prop("checked",!0),e.find(".custom-background-size-wrapper").show();const n=`${i}`.split(" ");if(2===n.length){const i=n[0].match(/[\d.]+/),c=`${n[0]}`.replace(i,"");e.find(t.customBackgroundWidthNumber).val(Array.isArray(i)?i[0]:""),e.find(t.customBackgroundWidthUnit).val(c);const o=n[1].match(/[\d.]+/),a=`${n[1]}`.replace(o,"");e.find(t.customBackgroundHeightNumber).val(Array.isArray(o)?o[0]:""),e.find(t.customBackgroundHeightUnit).val(a),e.find(".custom-background-size-wrapper").show()}}else o.filter(`[value="${i}"]`).prop("checked",!0);else o.val(i);else if("left"===i||"center"===i||"right"===i||"bottom"===i||"top"===i)o.filter(`[value="${i}"]`).prop("checked",!0);else{const t=`${i}`.match(/[\d.]+/),c=Array.isArray(t)?t[0]:"",a=`${i}`.replace(c,"");o.filter('[value="custom"]').prop("checked",!0),e.find(`.custom-${n}-wrapper`).show(),e.find(nameSelector(`custom_${n}_number`)).val(c),e.find(nameSelector(`custom_${n}_unit`)).val(a)}}))}toggleCustomWrappers(e),setHiddenValue(e.find('input[type="hidden"]'))})),n(document).on("change",t.backgroundImage,(function(){const t=n(this),e={};e["background-image"]=t.val(),setHiddenValue(t,e)})),n(document).on("click",t.horizontalAlignment,(function(){const t=n(this).closest(".background-image-wrapper");toggleCustomWrappers(t)})),n(document).on("click",t.verticalAlignment,(function(){const t=n(this).closest(".background-image-wrapper");toggleCustomWrappers(t)})),n(document).on("click",t.backgroundSize,(function(){const t=n(this).closest(".background-image-wrapper");toggleCustomWrappers(t)})),n(document).on("change keyup",`${t.horizontalAlignment}, ${t.customHorizontalNumber}, ${t.customHorizontalUnit}`,(function(){const t=n(this),e=t.closest(".background-image-wrapper"),i={};i.horizontal_alignment=getAlignmentValue(e,"horizontal"),toggleCustomWrappers(e),setHiddenValue(t,i)})),n(document).on("change keyup",`${t.verticalAlignment}, ${t.customVerticalNumber}, ${t.customVerticalUnit}`,(function(){const t=n(this),e=t.closest(".background-image-wrapper"),i={};i.vertical_alignment=getAlignmentValue(e,"vertical"),toggleCustomWrappers(e),setHiddenValue(t,i)})),n(document).on("click",".restore-radio-icon",(function(){const t=n(this).closest(".background-image-wrapper");toggleCustomWrappers(t),setHiddenValue(n(this))})),n(document).on("change",t.backgroundRepeat,(function(){const t=n(this),e={};e["background-repeat"]=t.val(),setHiddenValue(t,e)})),n(document).on("change",t.backgroundAttachment,(function(){const t=n(this),e={};e["background-attachment"]=t.val(),setHiddenValue(t,e)})),n(document).on("change keyup",`${t.backgroundSize}, ${t.customBackgroundWidthNumber}, ${t.customBackgroundWidthUnit}, ${t.customBackgroundHeightNumber}, ${t.customBackgroundHeightUnit}`,(function(){const t=n(this),e=t.closest(".background-image-wrapper"),i={};i["background-size"]=getBackgroundSizeValue(e)||t.val(),toggleCustomWrappers(e),setHiddenValue(t,i)}))}));