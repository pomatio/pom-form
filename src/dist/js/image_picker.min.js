jQuery((function(e){const renderPreview=function(t,i){const r="string"==typeof i?i.trim():"",a=t.find(".image-wrapper");a.empty(),r.length?(e("<img>",{width:"280px",alt:"",src:r}).appendTo(a),t.find(".remove-selected-image").css("display","inherit")):t.find(".remove-selected-image").css("display","none")},getPreviewUrl=function(e,t){if("url"===t.attr("type"))return t.val();const i=e.data("previewUrl");return"string"==typeof i?i:""};let t,i;e(".pomatio-framework-image-wrapper").each((function(){const t=e(this),i=t.find('input[data-type="image_picker"]').first();i.length&&renderPreview(t,getPreviewUrl(t,i))})),e(document).on("click",".open-image-picker",(function(r){r.preventDefault(),e(this).closest(".pomatio-framework-image-wrapper").find('input[data-type="image_picker"]').length&&(i=e(this),t||(t=wp.media.frames.file_frame=wp.media({title:pom_form_image_picker.title,button:{text:pom_form_image_picker.button},multiple:!1}),t.on("select",(function(){let e=t.state().get("selection").first().toJSON();const r=i.closest(".pomatio-framework-image-wrapper"),a=r.find('input[data-type="image_picker"]');"url"!==a.attr("type")?(r.data("previewUrl",e.url),r.attr("data-preview-url",e.url),a.val(e.id).trigger("change")):a.val(e.url).trigger("change")}))),t.open())})),e(document).on("input change",'.pomatio-framework-image-wrapper input[data-type="image_picker"]',(function(){!function(e){const t=e.closest(".pomatio-framework-image-wrapper");renderPreview(t,getPreviewUrl(t,e))}(e(this))})),e(document).on("click",".pomatio-framework-image-wrapper .remove-selected-image",(function(t){t.preventDefault();const i=e(this).closest(".pomatio-framework-image-wrapper");i.data("previewUrl",""),i.removeAttr("data-preview-url"),i.find('input[data-type="image_picker"]').val("").trigger("change")}))}));