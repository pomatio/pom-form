jQuery((function(e){const renderPreview=function(t,i){const r="string"==typeof i?i.trim():"",o=t.find(".image-wrapper");o.empty(),r.length?(e("<img>",{width:"280px",alt:"",src:r}).appendTo(o),t.find(".remove-selected-image").css("display","inherit")):t.find(".remove-selected-image").css("display","none")},getPreviewUrl=function(t,i){if("url"===i.attr("type"))return i.val();const r=t.data("previewUrl");return"string"==typeof r?r:""},renderPreviewFromInput=function(t){const i=t.closest(".pomatio-framework-image-wrapper");renderPreview(i,getPreviewUrl(i,t))};e(".pomatio-framework-image-wrapper").each((function(){const t=e(this),i=t.find('input[data-type="image_picker"]').first();i.length&&renderPreview(t,getPreviewUrl(t,i))}));let t,i;e(document).on("click",".open-image-picker",(function(r){r.preventDefault();const o=e(this).closest(".pomatio-framework-image-wrapper").find('input[data-type="image_picker"]');if(!o.length)return;i=e(this),t||(t=wp.media.frames.file_frame=wp.media({title:pom_form_image_picker.title,button:{text:pom_form_image_picker.button},multiple:!1}),t.on("select",(function(){let r=t.state().get("selection").first().toJSON(),o=i.closest(".pomatio-framework-image-wrapper"),a=o.find('input[data-type="image_picker"]');if("url"===a.attr("type"))return void a.val(r.url).trigger("change");o.data("previewUrl",r.url),o.attr("data-preview-url",r.url),a.val(r.id).trigger("change")}))),t.open()})),e(document).on("input change",'.pomatio-framework-image-wrapper input[data-type="image_picker"]',(function(){renderPreviewFromInput(e(this))})),e(document).on("click",".pomatio-framework-image-wrapper .remove-selected-image",(function(t){t.preventDefault();const i=e(this).closest(".pomatio-framework-image-wrapper");i.data("previewUrl",""),i.removeAttr("data-preview-url"),i.find('input[data-type="image_picker"]').val("").trigger("change")}))}));
