#!/usr/bin/env node
"use strict";const path=require("path");const sh=require("shelljs");const pkg=require("../package.json");const versionShort=pkg.config.version_short;const distFolder=`bootstrap-${pkg.version}-examples`;const rootDocsDir="_gh_pages";const docsDir=`${rootDocsDir}/docs/${versionShort}/`;const cssFiles=["bootstrap.min.css","bootstrap.min.css.map"];const jsFiles=["bootstrap.bundle.min.js","bootstrap.bundle.min.js.map"];const imgFiles=["bootstrap-outline.svg","bootstrap-solid.svg"];sh.config.fatal=true;if(!sh.test("-d",rootDocsDir)){throw new Error(`The "${rootDocsDir}" folder does not exist, did you forget building the docs?`)}sh.cd(path.join(__dirname,".."));sh.rm("-rf",[distFolder,`${distFolder}.zip`]);sh.mkdir("-p",[distFolder,`${distFolder}/assets/brand/`,`${distFolder}/assets/dist/css/`,`${distFolder}/assets/dist/js/`]);sh.cp("-Rf",`${docsDir}/examples/*`,distFolder);cssFiles.forEach(file=>{sh.cp("-f",`${docsDir}/dist/css/${file}`,`${distFolder}/assets/dist/css/`)});jsFiles.forEach(file=>{sh.cp("-f",`${docsDir}/dist/js/${file}`,`${distFolder}/assets/dist/js/`)});imgFiles.forEach(file=>{sh.cp("-f",`${docsDir}/assets/brand/${file}`,`${distFolder}/assets/brand/`)});sh.rm(`${distFolder}/index.html`);sh.find(`${distFolder}/**/*.html`).forEach(file=>{const fileContents=sh.cat(file).toString().replace(new RegExp(`"/docs/${versionShort}/`,"g"),'"../').replace(/"..\/dist\//g,'"../assets/dist/').replace(/(<link href="\.\.\/.*) integrity=".*>/g,"$1>").replace(/(<script src="\.\.\/.*) integrity=".*>/g,"$1><\/script>").replace(/( +)<!-- favicons(.|\n)+<style>/i,"    <style>");new sh.ShellString(fileContents).to(file)});sh.exec(`zip -r9 "${distFolder}.zip" "${distFolder}"`);sh.rm("-rf",distFolder);